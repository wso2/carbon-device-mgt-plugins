


var webSocket_api =function(){
    var api = this;
    api.wekSocket;
    api.message = function(holder){
        return $("#"+holder+"");

    },
    api.openSocket = function(url, callback){
        if(api.wekSocket !== undefined && api.wekSocket.readyState !== WebSocket.CLOSED){
            console.log("WebSocket is already opened.");

        }else{
            api.wekSocket = new WebSocket(url);
        }
        // Create a new instance of the websocket


        /**
         * Binds functions to the listeners for the websocket.
         */

        api.wekSocket.onopen = function(event){
            // For reasons I can't determine, onopen gets called twice
            // and the first time event.data is undefined.
            // Leave a comment if you know the answer.
            if(event.data === undefined)
                return;
            api.writeResponse(event.data);
            /*var resource = "";
            var from = event.data.from.split("/");
            if(from.length>1) resource = from[1];
            var jid = from[0];*/
            callback(event.data);
        };

        api.wekSocket.onmessage = function(event){
            api.writeResponse(event.data);
        };

        api.wekSocket.onclose = function(event){
            api.writeResponse(event.data);
        };
    },
    api.send = function(message){
        /*var text = document.getElementById("messageinput").value;*/
        api.wekSocket.send(message);
    },

    api.closeSocket = function(){
        api.wekSocket.close();
    },

    api.writeResponse = function(arg){
        console.log(arg);
    }
}


